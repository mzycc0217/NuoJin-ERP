<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../layui/css/layui.css">
    <script src="../layui/layui.all.js"></script>
    <script src="../JS/jquery-3.4.1/jquery-3.4.1.js"></script>
    <script src="../JS/funtion.js"></script>
    <script src="../UrlModel/url.js"></script>
    <title>åä¹‰ä¸‹å•å­Arr</title>
    <style>
        .wrap {
            margin: 20px;
        }
        
        .layui-tab-title>li {
            background-color: #009688;
            color: #fff;
            margin: 0 20px;
        }
        
        .layui-tab-card>.layui-tab-title li {
            margin: 0 50px;
        }
        
        .layui-tab-card>.layui-tab-title {
            background-color: #fff;
        }
        
        .layui-tab-item>div {
            display: none;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <div class="layui-tab layui-tab-card">
            <ul class="layui-tab-title">
                <li class="layui-this" id="billPurchaseBtn">é‡‡è´­å•</li>
                <li id="billChemicalBtn">åŒ–å­¦å•</li>
                <li id="billOfficeBtn">åŠå…¬å•</li>
                <li id="billProduct">äº§å“å•</li>
            </ul>
            <div class="layui-tab-content" style="height: 100%;">
                <div class="layui-tab-item layui-show">
                    <div class="mapHead">
                        <div style="display: flex;">
                            <button type="button" class="layui-btn layui-btn-normal" id="shaixuan">å·²å®¡æ‰¹</button>
                            <button type="button" class="layui-btn layui-btn-normal" id="weishenpi">æœªå®¡æ‰¹</button>
                            <button type="button" class="layui-btn layui-btn-normal" id="overGe">ä¸åˆæ ¼</button>
                            <form class="layui-form" action="" lay-filter="form_csts">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">åç§°</label>
                                    <div class="layui-input-block" style="width: 80%;">
                                        <input type="text" id="Project_Name" oninput="project()" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <table id="caigou" lay-filter="idTests"></table>
                        <script type="text/html" id="barDemo">
                            <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="over">åˆ é™¤</a>
                        </script>
                        <!--åºå·åˆ—-->
                        <script type="text/html" id="xuHao">
                            {{d.LAY_TABLE_INDEX+1}}
                        </script>
                    </div>
                </div>
                <div class="layui-tab-item">
                    <div class="chemisterFather">
                        <div style="display: flex;">
                            <button type="button" class="layui-btn layui-btn-normal" id="chemical_shaixuan">å·²å®¡æ‰¹</button>
                            <button type="button" class="layui-btn layui-btn-normal" id="chemical_weishenpi">æœªå®¡æ‰¹</button>
                            <button type="button" class="layui-btn layui-btn-normal" id="chemical_overGe">ä¸åˆæ ¼</button>
                            <form class="layui-form" action="" lay-filter="form_csts">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">åŸææ–™åç§°</label>
                                    <div class="layui-input-block" style="width: 80%;">
                                        <input type="text" id="chemical_Name" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <table id="caigou2" lay-filter="idTests2"></table>
                        <script type="text/html" id="barDemo2">
                            <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="over2">åˆ é™¤</a>
                        </script>
                        <!--åºå·åˆ—-->
                        <script type="text/html" id="xuHao">
                            {{d.LAY_TABLE_INDEX+1}}
                        </script>
                    </div>
                </div>
                <div class="layui-tab-item">
                    <div class="officeFather">
                        <div style="display: flex;">
                            <button type="button" class="layui-btn layui-btn-normal" id="office_shaixuan">å·²å®¡æ‰¹</button>
                            <button type="button" class="layui-btn layui-btn-normal" id="office_weishenpi">æœªå®¡æ‰¹</button>
                            <button type="button" class="layui-btn layui-btn-normal" id="office_overGe">ä¸åˆæ ¼</button>
                            <form class="layui-form" action="" lay-filter="form_csts">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">åŸææ–™åç§°</label>
                                    <div class="layui-input-block" style="width: 80%;">
                                        <input type="text" id="office_Name" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <table id="caigou3" lay-filter="idTests3"></table>
                        <script type="text/html" id="barDemo3">
                            <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="over3">åˆ é™¤</a>
                        </script>
                        <!--åºå·åˆ—-->
                        <script type="text/html" id="xuHao">
                            {{d.LAY_TABLE_INDEX+1}}
                        </script>
                    </div>
                </div>
                <!-- æˆå“åŠæˆå“ -->
                <div class="layui-tab-item">


                </div>
            </div>
        </div>
    </div>
    </div>
    <script type="text/html" id="xuHao">
        {{d.LAY_TABLE_INDEX+1}}
    </script>
</body>
<script>
    billPurchaseBtn();
    window.onload = function() {
        anomation();

    }

    function billPurchaseBtn() {
        $(".mapHead").css("display", "block")
        purchaseArr()
    }
    $("#billPurchaseBtn").click(function() {
        $(".mapHead").css("display", "block")
        purchaseArr()

    });
    $("#billChemicalBtn").click(function() {
        $(".chemisterFather").css("display", "block");
        ChemicalArr();
    })
    $("#billOfficeBtn").click(function() {
        $(".officeFather").css("display", "block");
        officeArr();

    })


    function purchaseArr() {
        audit('ZpurChase/GetZpurChaseTwoCaigoud'); //æ‰€æœ‰è¡¨å•
        function audit(URL) {
            layui.use(['element', 'jquery', 'table', 'layer', 'form'], function() {
                var element = layui.element;
                var $ = layui.jquery;
                var table = layui.table;
                var layer = layui.layer;
                var form = layui.form;
                table.render({
                    elem: '#caigou',
                    id: 'idTests',
                    height: 500,
                    limit: 10,
                    limits: [5, 10, 20],
                    page: true,
                    url: window.url + URL //æ•°æ®æ¥å£POST /api/Purchase/GetPurchaseList
                        ,
                    headers: {
                        Authorization: window.header.Ae,
                        UserId: window.header.Ud,
                        AppFlag: window.header.Fg
                    },
                    method: 'post',
                    cols: [
                        [{
                            type: 'checkbox',
                            fixed: 'left'
                        }, {
                            title: 'åºå·',
                            fixed: 'left',
                            templet: '#xuHao',
                        }, {
                            field: 'z_Raw',
                            title: 'åŸææ–™',
                            fixed: 'left',
                            templet: function(res) {
                                // 
                                if (res.z_Raw == null) {
                                    return "æ— "
                                } else {
                                    return res.z_Raw.Name
                                }
                            }
                        }, {
                            field: 'Z_RowType',
                            title: 'ç±»å‹',
                            fixed: 'left',
                            templet: function(res) {
                                if (res.Z_RowType == null) {
                                    return "æ— "
                                } else {
                                    return res.Z_RowType.Name
                                }
                            }

                        }, {
                            field: 'Project',
                            title: 'é¡¹ç›®',
                            fixed: 'left',
                            templet: function(res) {
                                return res.Project.Name
                            }
                        }, {
                            field: 'ApplyNumber',
                            title: 'ç”³è¯·æ•°é‡',
                        }, {
                            field: 'Company',
                            title: 'å•ä½',
                            templet: function(res) {
                                if (res.company == null) {
                                    return "æ— "
                                } else {
                                    return res.company.Name
                                }
                            }
                        }, {
                            field: 'ApprovalDesc',
                            title: 'ç”³è¯·äººå¤‡æ³¨è¯´æ˜',
                        }, {
                            field: 'ApplyTime',
                            title: 'ç”³è¯·æ—¥æœŸ',
                            templet: function(res) {
                                return showTime(res.ApplyTime);
                            }
                        }, {
                            fixed: 'right',
                            title: 'æ“ä½œ',
                            width: 240,
                            toolbar: '#barDemo',
                        }]
                    ],
                    request: {
                        pageName: 'PageIndex' // é¡µç çš„å‚æ•°åç§°ï¼Œé»˜è®¤ï¼špage
                            ,
                        limitName: 'PageSize' //æ¯é¡µæ•°æ®é‡çš„å‚æ•°åï¼Œé»˜è®¤ï¼šlimit
                    },
                    parseData: (res) => { //å°†åŸå§‹æ•°æ®è§£ææˆÂ tableÂ ç»„ä»¶æ‰€è§„å®šçš„æ•°æ®
                        console.log('%c ğŸ« res: ', 'font-size:20px;background-color: #42b983;color:#fff;', res);
                        return {
                            "code": 0, //è§£ææ¥å£çŠ¶æ€
                            "msg": "æˆåŠŸ", //è§£ææç¤ºæ–‡æœ¬
                            "count": res.Count.Result, //æ€»æ•°
                            data: res.data //è§£ææ•°æ®åˆ—è¡¨
                        }
                    }
                });
                //ç›‘å¬è¡Œå·¥å…·äº‹ä»¶
                table.on('tool(idTests)', function(obj) { //æ³¨ï¼štool æ˜¯å·¥å…·æ¡äº‹ä»¶åï¼Œtest æ˜¯ table åŸå§‹å®¹å™¨çš„å±æ€§ lay-filter="å¯¹åº”çš„å€¼"
                    var data = obj.data //è·å¾—å½“å‰è¡Œæ•°æ®
                    layEvent = obj.event; //è·å¾— lay-event å¯¹åº”çš„å€¼
                    if (layEvent === 'over') {
                        var wareArr = [];
                        wareArr.push(data.PurchaseId);
                        layer.confirm('çœŸçš„åˆ é™¤è¡Œä¹ˆ', function(index) {
                            //å‘æœåŠ¡ç«¯å‘é€åˆ é™¤æŒ‡ä»¤
                            $.ajax({
                                type: "POST",
                                url: window.url + "ZpurChase/RemovePursh",
                                headers: {
                                    Authorization: window.header.Ae,
                                    UserId: window.header.Ud,
                                    AppFlag: window.header.Fg
                                },
                                contentType: "application/json",
                                data: JSON.stringify({
                                    Del_Id: wareArr
                                }),
                                success: function(res) {
                                    table.reload('idTests')
                                    layer.close(index)
                                },
                                error: function(res) {
                                    layer.msg(res);
                                }
                            })
                        });
                    }
                });
            });

        }
        // å®¡æ‰¹å®Œæˆ
        $("#shaixuan").on('click', function() {
                $("#shaixuan").css("background", "green");
                $("#overGe").css("background", "#1E9FFF");
                $("#weishenpi").css("background", "#1E9FFF");
                audit('ZpurChase/GetZpurChaseOneCaigoud')
            })
            // æœªå®¡æ‰¹
        $("#weishenpi").click(function() {
            $("#weishenpi").css("background", "green");
            $("#shaixuan").css("background", "#1E9FFF");
            $("#overGe").css("background", "#1E9FFF");
            audit('ZpurChase/GetZpurChaseThreeCaigoud')
        });
        // é©³å›çš„
        $("#overGe").click(function() {
            $("#overGe").css("background", "green");
            $("#shaixuan").css("background", "#1E9FFF");
            $("#weishenpi").css("background", "#1E9FFF");
            audit('ZpurChase/GetRejectPursh')
        })
    }


    function ChemicalArr() {
        chemisterAudit('ChemistryMonad/GetChemistryMonadTwoCaigoud'); //æ‰€æœ‰è¡¨å• 
        function chemisterAudit(URL) {
            layui.use(['element', 'jquery', 'table', 'layer', 'form'], function() {
                var element = layui.element;
                var $ = layui.jquery;
                var table = layui.table;
                var layer = layui.layer;
                var form = layui.form;
                table.render({
                    elem: '#caigou2',
                    id: 'idTests2',
                    height: 515,
                    limit: 10,
                    limits: [5, 10, 20],
                    page: true,
                    url: window.url + URL //æ•°æ®æ¥å£POST /api/Purchase/GetPurchaseList
                        ,
                    headers: {
                        Authorization: window.header.Ae,
                        UserId: window.header.Ud,
                        AppFlag: window.header.Fg
                    },
                    method: 'post',
                    cols: [
                        [{
                            type: 'checkbox',
                            fixed: 'left'
                        }, {
                            title: 'åºå·',
                            fixed: 'left',
                            templet: '#xuHao',
                        }, {
                            field: 'Z_Chemistry',
                            title: 'åŒ–å­¦',
                            fixed: 'left',
                            templet: function(res) {
                                // 
                                if (res.Z_Chemistry == null) {
                                    return "æ— "
                                } else {
                                    return res.Z_Chemistry.Name
                                }
                            }
                        }, {
                            field: 'Z_Chemistry.Z_ChemistryType',
                            title: 'ç±»å‹',
                            fixed: 'left',
                            templet: function(res) {
                                if (res.Z_Chemistry.Z_ChemistryType == null) {
                                    return "æ— "
                                } else {
                                    return res.Z_Chemistry.Z_ChemistryType.Name
                                }
                            }

                        }, {
                            field: 'ApplyNumber ',
                            title: 'ç”³è¯·æ•°é‡',
                        }, {
                            field: 'Company',
                            title: 'å•ä½',
                            templet: function(res) {
                                if (res.Company == null) {
                                    return "æ— "
                                } else {
                                    return res.Company.Name
                                }
                            }
                        }, {
                            field: 'ApplicantRemarks',
                            title: 'ç”³è¯·äººå¤‡æ³¨è¯´æ˜',
                        }, {
                            field: 'ApplyTime',
                            title: 'ç”³è¯·æ—¥æœŸ',
                            templet: function(res) {
                                return showTime(res.ApplyTime);
                            }
                        }, {
                            fixed: 'right',
                            title: 'æ“ä½œ',
                            width: 240,
                            toolbar: '#barDemo2',
                        }]
                    ],
                    request: {
                        pageName: 'PageIndex' // é¡µç çš„å‚æ•°åç§°ï¼Œé»˜è®¤ï¼špage
                            ,
                        limitName: 'PageSize' //æ¯é¡µæ•°æ®é‡çš„å‚æ•°åï¼Œé»˜è®¤ï¼šlimit
                    },
                    parseData: (res) => { //å°†åŸå§‹æ•°æ®è§£ææˆÂ tableÂ ç»„ä»¶æ‰€è§„å®šçš„æ•°æ®
                        console.log('%c ğŸ– res: ', 'font-size:20px;background-color: #4b4b4b;color:#fff;', res);
                        return {
                            "code": 0, //è§£ææ¥å£çŠ¶æ€
                            "msg": "æˆåŠŸ", //è§£ææç¤ºæ–‡æœ¬
                            "count": res.Count, //æ€»æ•°
                            data: res.data //è§£ææ•°æ®åˆ—è¡¨
                        }
                    }
                });
                //ç›‘å¬è¡Œå·¥å…·äº‹ä»¶
                table.on('tool(idTests2)', function(obj) { //æ³¨ï¼štool æ˜¯å·¥å…·æ¡äº‹ä»¶åï¼Œtest æ˜¯ table åŸå§‹å®¹å™¨çš„å±æ€§ lay-filter="å¯¹åº”çš„å€¼"
                    var data = obj.data //è·å¾—å½“å‰è¡Œæ•°æ®
                    layEvent = obj.event; //è·å¾— lay-event å¯¹åº”çš„å€¼
                    if (layEvent === 'over2') {
                        var wareArr = [];
                        wareArr.push(data.PurchaseId);
                        layer.confirm('çœŸçš„åˆ é™¤è¡Œä¹ˆ', function(index) {
                            //å‘æœåŠ¡ç«¯å‘é€åˆ é™¤æŒ‡ä»¤
                            $.ajax({
                                type: "POST",
                                url: window.url + "ChemistryMonad/RemoveChemistryMonad",
                                headers: {
                                    Authorization: window.header.Ae,
                                    UserId: window.header.Ud,
                                    AppFlag: window.header.Fg
                                },
                                contentType: "application/json",
                                data: JSON.stringify({
                                    Del_Id: wareArr
                                }),
                                success: function(res) {
                                    table.reload('idTests2')
                                    layer.close(index)
                                },
                                error: function(res) {
                                    layer.msg(res);
                                }
                            })
                        });
                    }
                });
            });

        }
        // å®¡æ‰¹å®Œæˆ
        $("#chemical_shaixuan").on('click', function() {
                $("#chemical_shaixuan").css("background", "green");
                $("#chemical_overGe").css("background", "#1E9FFF");
                $("#chemical_weishenpi").css("background", "#1E9FFF");
                chemisterAudit('ChemistryMonad/GetChemistryMonadCaigoudk')
            })
            // æœªå®¡æ‰¹
        $("#chemical_weishenpi").click(function() {
            $("#chemical_weishenpi").css("background", "green");
            $("#chemical_shaixuan").css("background", "#1E9FFF");
            $("#chemical_overGe").css("background", "#1E9FFF");
            chemisterAudit('ChemistryMonad/GetChemistryMonadCaigoudp')
        });
        // é©³å›çš„
        $("#chemical_overGe").click(function() {
            $("#chemical_overGe").css("background", "green");
            $("#chemical_shaixuan").css("background", "#1E9FFF");
            $("#chemical_weishenpi").css("background", "#1E9FFF");
            chemisterAudit('ChemistryMonad/GetRejectChemistryMonad')
        })
    }



    function officeArr() {
        officeAudit('OfficeMonad/GetOfficeMonadTwoCaigoud'); //æ‰€æœ‰è¡¨å•
        function officeAudit(URL) {
            layui.use(['element', 'jquery', 'table', 'layer', 'form'], function() {
                var element = layui.element;
                var $ = layui.jquery;
                var table = layui.table;
                var layer = layui.layer;
                var form = layui.form;
                table.render({
                    elem: '#caigou3',
                    id: 'idTests3',
                    height: 515,
                    limit: 10,
                    limits: [5, 10, 20],
                    page: true,
                    url: window.url + URL //æ•°æ®æ¥å£POST /api/Purchase/GetPurchaseList
                        ,
                    headers: {
                        Authorization: window.header.Ae,
                        UserId: window.header.Ud,
                        AppFlag: window.header.Fg
                    },
                    method: 'post',
                    cols: [
                        [{
                            type: 'checkbox',
                            fixed: 'left'
                        }, {
                            title: 'åºå·',
                            fixed: 'left',
                            templet: '#xuHao',
                        }, {
                            field: 'Z_Office',
                            title: 'åŒ–å­¦',
                            fixed: 'left',
                            templet: function(res) {
                                // 
                                if (res.Z_Office == null) {
                                    return "æ— "
                                } else {
                                    return res.Z_Office.Name
                                }
                            }
                        }, {
                            field: 'Z_Office.Z_OfficeType',
                            title: 'ç±»å‹',
                            fixed: 'left',
                            templet: function(res) {
                                if (res.Z_Office.Z_OfficeType == null) {
                                    return "æ— "
                                } else {
                                    return res.Z_Office.Z_OfficeType.Name
                                }
                            }

                        }, {
                            field: 'ApplyNumber',
                            title: 'ç”³è¯·æ•°é‡',
                        }, {
                            field: 'Company',
                            title: 'å•ä½',
                            templet: function(res) {
                                if (res.Company == null) {
                                    return "æ— "
                                } else {
                                    return res.Company.Name
                                }
                            }
                        }, {
                            field: 'ApplicantRemarks',
                            title: 'ç”³è¯·äººå¤‡æ³¨è¯´æ˜',
                        }, {
                            field: 'ApplyTime',
                            title: 'ç”³è¯·æ—¥æœŸ',
                            templet: function(res) {
                                return showTime(res.ApplyTime);
                            }
                        }, {
                            fixed: 'right',
                            title: 'æ“ä½œ',
                            width: 240,
                            toolbar: '#barDemo2',
                        }]
                    ],
                    request: {
                        pageName: 'PageIndex' // é¡µç çš„å‚æ•°åç§°ï¼Œé»˜è®¤ï¼špage
                            ,
                        limitName: 'PageSize' //æ¯é¡µæ•°æ®é‡çš„å‚æ•°åï¼Œé»˜è®¤ï¼šlimit
                    },
                    parseData: (res) => { //å°†åŸå§‹æ•°æ®è§£ææˆÂ tableÂ ç»„ä»¶æ‰€è§„å®šçš„æ•°æ®
                        console.log('%c ğŸ» res: ', 'font-size:20px;background-color: #42b983;color:#fff;', res);
                        return {
                            "code": 0, //è§£ææ¥å£çŠ¶æ€
                            "msg": "æˆåŠŸ", //è§£ææç¤ºæ–‡æœ¬
                            "count": res.Count, //æ€»æ•°
                            data: res.data //è§£ææ•°æ®åˆ—è¡¨
                        }
                    }
                });
                //ç›‘å¬è¡Œå·¥å…·äº‹ä»¶
                table.on('tool(idTests3)', function(obj) { //æ³¨ï¼štool æ˜¯å·¥å…·æ¡äº‹ä»¶åï¼Œtest æ˜¯ table åŸå§‹å®¹å™¨çš„å±æ€§ lay-filter="å¯¹åº”çš„å€¼"
                    var data = obj.data //è·å¾—å½“å‰è¡Œæ•°æ®
                    layEvent = obj.event; //è·å¾— lay-event å¯¹åº”çš„å€¼
                    if (layEvent === 'over3') {
                        var wareArr = [];
                        wareArr.push(data.PurchaseId);
                        layer.confirm('çœŸçš„åˆ é™¤è¡Œä¹ˆ', function(index) {
                            //å‘æœåŠ¡ç«¯å‘é€åˆ é™¤æŒ‡ä»¤
                            $.ajax({
                                type: "POST",
                                url: window.url + "OfficeMonad/RemoveOfficeMonad",
                                headers: {
                                    Authorization: window.header.Ae,
                                    UserId: window.header.Ud,
                                    AppFlag: window.header.Fg
                                },
                                contentType: "application/json",
                                data: JSON.stringify({
                                    Del_Id: wareArr
                                }),
                                success: function(res) {
                                    table.reload('idTests2')
                                    layer.close(index)
                                },
                                error: function(res) {
                                    layer.msg(res);
                                }
                            })
                        });
                    }
                });
            });

        }
        // å®¡æ‰¹å®Œæˆ
        $("#office_shaixuan").on('click', function() {
                $("#office_shaixuan").css("background", "green");
                $("#office_overGe").css("background", "#1E9FFF");
                $("#office_weishenpi").css("background", "#1E9FFF");
                officeAudit('OfficeMonad/GetOfficeMonadCaigoudd')
            })
            // æœªå®¡æ‰¹
        $("#office_weishenpi").click(function() {
            $("#office_weishenpi").css("background", "green");
            $("office_shaixuan").css("background", "#1E9FFF");
            $("#office_overGe").css("background", "#1E9FFF");
            officeAudit('OfficeMonad/GetOfficeMonadCaigoudp')
        });
        // é©³å›çš„
        $("#office_overGe").click(function() {
            $("#office_overGe").css("background", "green");
            $("#office_shaixuan").css("background", "#1E9FFF");
            $("#office_weishenpi").css("background", "#1E9FFF");
            officeAudit('OfficeMonad/GetRejectOfficeMonad')
        })
    }
</script>

</html>