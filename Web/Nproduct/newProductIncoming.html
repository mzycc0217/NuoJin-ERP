<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../Layui/layui-v2.5.6/layui/css/layui.css">
    <script src="../UrlModel/url.js"></script>
    <script src="../Layui/layui-v2.5.6/layui/layui.all.js"></script>
    <script src="../JS/jquery-3.4.1/jquery-3.4.1.js"></script>
    <script src="../Layui/layui-v2.5.6/layui/lay/modules/layer.js"></script>
    <script src="../Layui/layui-v2.5.6/layui/lay/modules/laydate.js"></script>
    <title>å®Œæˆå…¥åº“</title>
</head>

<body>
    <div class="layui-tab">
        <div class="demoTable">
            æœç´¢åç§°ï¼š
            <div class="layui-inline">
                <input class="layui-input" name="name" id="productName" autocomplete="off" />
            </div>
            <button class="layui-btn" data-type="reload">æœç´¢</button>
        </div>
        <table class="layui-hide" id="test4" lay-filter="test4"></table>
        <!--åºå·åˆ—-->
        <script type="text/html" id="xuHao">
            {{d.LAY_TABLE_INDEX+1}}
        </script>
        <!--ä¿¡æ¯-->
        <script type="text/html" id="buttonTpl">
            {{# if(d.z_FnishedProduct.Finshed_Sign == 1){ }}
            <button class="layui-btn layui-btn-warm layui-btn-xs">æˆå“</button> {{# } else if(d.z_FnishedProduct.Finshed_Sign == 2) { }}
            <button class="layui-btn  layui-btn-xs">åŠæˆå“</button> {{# } }}
        </script>
</body>
<script>
    window.onload = function() {
        anomation();
    }

    layui.use(['laypage', 'layer', 'table', 'element', 'jquery', 'form'], function() {
        var laypage = layui.laypage //åˆ†é¡µ
            ,
            layer = layui.layer //å¼¹å±‚
            ,
            table = layui.table //è¡¨æ ¼
            ,
            element = layui.element //å…ƒç´ æ“ä½œ
            ,
            form = layui.form;

        table.render({
            elem: '#test4',
            height: 515,
            url: window.url + 'FinshedProductMonad/GetFinshedProductMonads' //æ•°æ®æ¥å£
                ,
            title: 'æ£€éªŒå…¥åº“',
            id: 'testReload4',
            toolbar: '#toolbarDemo4' //å¼€å¯å¤´éƒ¨å·¥å…·æ ï¼Œå¹¶ä¸ºå…¶ç»‘å®šå·¦ä¾§æ¨¡æ¿
                ,
            headers: {
                Authorization: window.header.Ae,
                UserId: window.header.Ud,
                AppFlag: window.header.Fg
            },
            method: 'post',
            page: true, //å¼€å¯åˆ†é¡µ
            limit: 10,

            cols: [
                [{
                    type: 'checkbox',
                    fixed: 'left'
                }, {
                    title: 'åºå·',
                    fixed: 'left',
                    templet: '#xuHao',
                }, {
                    field: 'z_FnishedProduct.Name',
                    title: 'äº§æˆå“',
                    fixed: 'left',
                    templet: function(res) {
                        if (res.z_FnishedProduct == null || res.z_FnishedProduct.Name == null) {
                            return "æ— "
                        } else {
                            return res.z_FnishedProduct.Name;
                        }
                    }
                }, {
                    field: 'z_FnishedProduct.Z_FinshedProductType.Name',
                    title: 'ç±»å‹',
                    fixed: 'left',
                    templet: function(res) {
                        if (res.z_FnishedProduct.Z_FinshedProductType == null || res.z_FnishedProduct.Z_FinshedProductType.Name == null) {
                            return "æ— "
                        } else {
                            return res.z_FnishedProduct.Z_FinshedProductType.Name;
                        }
                    }
                }, {
                    field: 'Finshed_Sign',
                    title: 'å‡ºå”®ç±»å‹',
                    fixed: 'left',
                    templet: '#buttonTpl',
                    minWidth: 150,
                    align: 'center'

                }, {
                    field: 'ApplyNumber',
                    title: 'å…¥åº“æ•°é‡',
                }, {
                    field: 'Company',
                    title: 'å•ä½',
                    templet: function(res) {
                        if (res.Company == null || res.Company.Name == null) {
                            return "æ— "
                        } else {
                            return res.Company.Name;
                        }
                    }
                }, {
                    field: 'ApplyTime',
                    title: 'ç”³è¯·æ—¥æœŸ',
                    templet: function(res) {
                        return showTime(res.ApplyTime);
                    }
                }]
            ],
            request: {
                pageName: 'PageIndex' // é¡µç çš„å‚æ•°åç§°ï¼Œé»˜è®¤ï¼špage
                    ,
                limitName: 'PageSize' //æ¯é¡µæ•°æ®é‡çš„å‚æ•°åï¼Œé»˜è®¤ï¼šlimit
            },
            parseData: (res) => { //å°†åŸå§‹æ•°æ®è§£ææˆÂ tableÂ ç»„ä»¶æ‰€è§„å®šçš„æ•°æ®
                console.log('%c ğŸ» res: ', 'font-size:20px;background-color: #FFDD4D;color:#fff;', res);

                return {
                    "code": 0, //è§£ææ¥å£çŠ¶æ€
                    "msg": "æˆåŠŸ", //è§£ææç¤ºæ–‡æœ¬
                    "count": res.Count, //æ€»æ•°
                    data: res.data //è§£ææ•°æ®åˆ—è¡¨
                }
            }
        });

        //å¯»æ‰¾æ•°æ®
        $('.layui-btn').on('click', function() {
            var productName = $("#productName").val();
            //æ‰§è¡Œé‡è½½
            table.reload('testReload4', {
                page: {
                    curr: 1 //é‡æ–°ä»ç¬¬ 1 é¡µå¼€å§‹
                },
                where: {
                    Name: productName
                }
            }, 'data');
        });
        //åˆ†é¡µ
        laypage.render({
            elem: 'pageDemo' //åˆ†é¡µå®¹å™¨çš„id
                ,
            count: 100 //æ€»é¡µæ•°
                ,
            skin: '#1E9FFF' //è‡ªå®šä¹‰é€‰ä¸­è‰²å€¼
                ,
            jump: function(obj, first) {
                if (!first) {
                    layer.msg('ç¬¬' + obj.curr + 'é¡µ', {
                        offset: 'b'
                    });
                }
            }
        });
    });
</script>

</html>