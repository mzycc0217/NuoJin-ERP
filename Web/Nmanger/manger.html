<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="../UrlModel/url.js"></script>
    <script src="../JS/jquery-3.4.1/jquery-3.4.1.js"></script>
    <style>
        th {
            height: 50px;
        }
        
        td {
            width: 134px;
            height: 60px;
        }
        
        input {
            outline: none;
            border: none;
            width: 134px;
            text-align: center;
            font-size: 16px;
        }
        
        table {
            text-align: center;
            margin-top: 200px;
        }
        
        #sex,
        #Departments,
        #UserTypeStr {
            height: 60px;
            outline: none;
            border: none;
            font-size: 16px;
        }
        
        button {
            margin: 10px 6px;
            width: 160px;
            height: 40px;
            border-width: 0px;
            border-radius: 3px;
            background: #1E90FF;
            cursor: pointer;
            outline: none;
            font-family: Microsoft YaHei;
            color: white;
            font-size: 17px;
        }
        
        button:hover {
            background: #5599FF;
        }
    </style>
</head>

<body>
    <form action="" id=form>
        <table border="1" cellspacing="0" align="center">
            <tr>
                <th colspan="8">åŸºæœ¬èµ„æ–™</th>
            </tr>
            <tr>
                <td>å§“å</td>
                <td>
                    <input type="text" placeholder="" name="" value="" id="RealName">
                </td>
                <td>æ€§åˆ«</td>
                <td>
                    <select name="" id="sex">
                        <option value="ç”·">ç”·</option>
                        <option value="å¥³">å¥³</option>
                    </select>
                </td>
                <td colspan="2">å‡ºç”Ÿæ—¥æœŸ</td>
                <td>
                    <input type="date" placeholder="" name="" value="" id="test1">
                </td>

            </tr>
            <tr>
                <td>éƒ¨é—¨</td>
                <td colspan="2">
                    <select name="" id="Departments" class="departs">
                    </select>
                </td>

                <td>èŒä½</td>
                <td colspan="3">
                    <select name="" id="UserTypeStr" class="typs">
                        <option value="UserTypeStr" id="UserTypeStrs"></option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>ç”µè¯</td>
                <td colspan="2">
                    <input type="tel" placeholder="" name="" value="" style="width: 90%;" id="phones">
                </td>
                <td>å¾®ä¿¡</td>
                <td colspan="3">
                    <input type="text" placeholder="" name="" value="" style="width: 90%;" id="weixin">
                </td>
            </tr>
            <tr>
                <td>æ°‘æ—</td>
                <td>
                    <input type="text" placeholder="" name="" value="" id="upnation">
                </td>
                <td>èº«ä»½è¯å·</td>
                <td colspan="4">
                    <input type="text" placeholder="" name="" value="" style="width: 90%;" id="Numberst">
                </td>
            </tr>
            <tr>
                <td>æœ€é«˜å­¦å†</td>
                <td>
                    <input type="text" placeholder="" name="" value="" id="upnations">
                </td>
                <td>E-mail</td>
                <td colspan="4">
                    <input type="email" name="" style="width: 90%;" id="Emails">
                </td>
            </tr>

            <tr>
                <td>ä½å€</td>
                <td colspan="6">
                    <input type="text" placeholder="" name="" value="" style="width: 90%;" id="address">
                </td>
            </tr>

        </table>
    </form>
    <div align="center"><button type="submit" id="submit">ç«‹å³æäº¤</button> <button type="reset" id="reset">é‡ç½®</button></div>
</body>
<script>
   window.onload = function() {
        bumen();
              user();
             
              depart();
          //  anomation();
        }
   

    function user() {Â Â Â Â Â Â Â Â Â 
        $.ajax({Â Â Â Â Â Â Â Â Â Â Â Â 
            url: window.url + "User/GetUserList", //åå°è¯·æ±‚çš„æ•°æ®
            dataType: "json", //æ•°æ®æ ¼å¼
            type: "post", //è¯·æ±‚æ–¹å¼
            data: {
                UserId: localStorage.getItem('UserId')
            },
            headers: Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                Authorization: Â window.header.Ae,
                UserId: Â window.header.Ud,
                AppFlag: Â window.header.FgÂ Â Â Â Â Â Â Â Â Â Â Â 
            },
            success: function(data) {Â Â  //å¦‚æœè¯·æ±‚æˆåŠŸï¼Œè¿”å›æ•°æ®ã€‚
                //çœŸå®å§“åï¼š RealNameï¼Œéƒ¨é—¨ï¼šDepartment.Name èŒä½ï¼šUserTypeStrï¼Œæ€§åˆ«ï¼šSexTypeStrï¼Œæ°‘æ—ï¼šNationï¼Œ
                //å‡ºç”Ÿæ—¥æœŸï¼šDateOfBirthï¼Œèº«ä»½è¯å·ï¼šIdCard ï¼Œæœ€é«˜å­¦å†ï¼šEducationï¼Œ
                //ç”µè¯ï¼šPhoneï¼Œé‚®ç®±ï¼šEmail ï¼Œå¾®ä¿¡ï¼šWeiXin ï¼Œåœ°å€ï¼šAddress ï¼Œå¯†ç ï¼šAddress 
                var data = data[0];
                console.log('%c ğŸ¾ data: ', 'font-size:20px;background-color: #EA7E5C;color:#fff;', data);
               // console.log(data)
                $("#RealName").val(data.RealName)
                $("#Departments").val(data.DepartmentId) //data.DepartmentId
                console.log('%c ğŸ  data.DepartmentId: ', 'font-size:20px;background-color: #EA7E5C;color:#fff;', data.DepartmentId);
                $("#UserTypeStrs").val(data.UserType[0].UserType.Desc)
                $("#upsexs").val(data.SexType)
                $("#upnation").val(data.Nation)
                $("#test1").val((data.DateOfBirth).slice(0, 10))
                $("#Numberst").val(data.IdCard)
                $("#upnations").val(data.Education)
                $("#phones").val(data.Phone)
                $("#Emails").val(data.Email)
                $("#weixin").val(data.WeiXin)
                $("#address").val(data.Address)
              //  bumen()

            },
            Â Â Â Â Â Â Â Â Â 
        })Â Â 

     
    }

   
            //è·å–éƒ¨é—¨
        function bumen() {
            $.ajax({
                type: "POST",
                url: window.url + "Department/GetDepartmentList",
                Â headers: Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                    Authorization: Â window.header.Ae,
                    UserId: Â window.header.Ud,
                    AppFlag: Â window.header.FgÂ Â Â Â Â Â Â Â Â Â Â Â 
                },
                data: {
                    DepartmentName: "",
                    PageIndex: 0,
                    PageSize: 0
                },
                success: function(bmlist) {
                    var data = bmlist[0].Count;
                    var str = "";
                    for (var i = 0; i < bmlist.length; i++) {
                        str += '<option value="' + bmlist[i].DepartmentId + '">' + bmlist[i].Name + '</option>';
                    }

                    $(".departs").html(str);
                }
            })Â Â Â Â 
        }
        //è·å–èŒä½ç±»å‹
      

        function depart() {
            $.ajax({
                url: window.url + "User/GetUserTypeList", //POST /api/User/GetUserTypeList
                type: "post",
                data: {
                    PageIndex: 0,
                    PageSize: 0
                },
                Â headers: Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                    Authorization: Â window.header.Ae,
                    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â UserId: Â window.header.Ud,
                    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AppFlag: Â window.header.FgÂ Â Â Â Â Â Â Â Â Â Â Â 
                },
                success: (res) => {
                    var data = res[0].Count;
                    var str = "";
                    for (var i = 0; i < res.length; i++) {
                        str += '<option value="' + res[i].UserTypeId + '">' + res[i].Name + '</option>';
                    }
                    $(".typs").html(str);

                }
            })


        }
    //ä¿®æ”¹èµ„æ–™

    $("#submit").on('click', function() {
     

        $.ajax({
            url: window.url + "User/Update", //POST POST /api/User/Update
            type: "post",
          //  async: false,
            data: {
                UserId: localStorage.getItem('UserId'),
                RealeName: $("#RealName").val(),
                UserTypeId: $("#UserTypeStr").val(),
                DepartmentId: $("#Departments").val(),
                SexType: $("#upsexs").val(),
                Nation: $("#upnation").val(),
                Education: $("#upnations").val(),
                DateOfBirth: $("#test1").val(),
                Phone: $("#phones").val(),
                Email: $("#Emails").val(),
                WeiXin: $("#weixin").val(),
                IdCard: $("#Numberst").val(),
                Address: $("#address").val()
            },
            Â headers: Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                Authorization: Â window.header.Ae,
                Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â UserId: Â window.header.Ud,
                Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AppFlag: Â window.header.FgÂ Â Â Â Â Â Â Â Â Â Â Â 
            },
            success: (res) => {
                console.log('%c ğŸ¾ res: ', 'font-size:20px;background-color: #EA7E5C;color:#fff;', res);

                alert("æäº¤æˆåŠŸ")
                user()

            }

        })
    })
    $('#reset').on('click', function() {
        document.getElementById("form").reset();

    })
</script>

</html>