<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../layui/css/layui.css">
    <script src="../layui/layui.all.js"></script>
    <script src="../JS/jquery-3.4.1/jquery-3.4.1.js"></script>
    <script src="../JS/funtion.js"></script>
    <script src="../UrlModel/url.js"></script>
    <title>å…¥åº“ç”³è¯·å•å­Arr</title>
    <style>
        .wrap {
            margin: 20px;
        }
        
        .layui-tab-title>li {
            background-color: #009688;
            color: #fff;
            margin: 0 20px;
        }
        
        .layui-tab-card>.layui-tab-title li {
            margin: 0 50px;
        }
        
        .layui-tab-card>.layui-tab-title {
            background-color: #fff;
        }
        
        .layui-tab-item>div {
            display: none;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <div class="layui-tab layui-tab-card" id="ss">
            <ul class="layui-tab-title">
                <li class="layui-this" id="billPurchaseBtn">é‡‡è´­å•</li>
                <li id="billChemicalBtn">åŒ–å­¦å•</li>
                <li id="billOfficeBtn">åŠå…¬å•</li>
                <li id="billProductBtn">äº§å“å•</li>
            </ul>
            <div class="layui-tab-content" style="height: 100%;">
                <div class="layui-tab-item layui-show">
                    <div class="mapHead">
                        <div class="demoTable">
                            æœç´¢åŸæ–™åç§°ï¼š
                            <div class="layui-inline">
                                <input class="layui-input" name="name" id="keyName" autocomplete="off" />
                            </div>
                            <button class="layui-btn" data-type="reload">æœç´¢</button>
                        </div>
                        <table class="layui-hide" id="test1" lay-filter="test1"></table>

                        <div class="site-text" style="margin: 5%; display: none" id="box3" target="test123">
                            <form class="layui-form layui-form-pane" onsubmit="return false" id="book3" lay-filter="t3">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">å¤‡æ³¨</label>
                                    <div class="layui-input-block">
                                        <input id="des" class="layui-input" /></br>
                                    </div>
                                    <label class="layui-form-label">ä»“åº“</label>
                                    <div class="layui-input-block">
                                        <select id="warehouseId"></select>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="site-text" style="margin: 5%; display: none" id="box4" target="test123">
                            <form class="layui-form layui-form-pane" onsubmit="return false" id="book4" lay-filter="t4">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">å¤‡æ³¨</label>
                                    <div class="layui-input-block">
                                        <input id="des1" class="layui-input" /></br>
                                    </div>
                                    <label class="layui-form-label">ä»“åº“</label>
                                    <div class="layui-input-block">
                                        <select id="warehouseId"></select>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <script type="text/html" id="barDemo">
                            <a class="layui-btn layui-btn-xs" lay-event="edit">å…¥åº“</a>
                        </script>
                        <!--åºå·åˆ—-->
                        <script type="text/html" id="xuHao">
                            {{d.LAY_TABLE_INDEX+1}}
                        </script>
                    </div>
                </div>
                <div class="layui-tab-item">
                    <div class="chemisterFather">
                        <div class="demoTable">
                            æœç´¢åç§°ï¼š
                            <div class="layui-inline">
                                <input class="layui-input" name="name" id="chemisterName" autocomplete="off" />
                            </div>
                            <button class="layui-btn" data-type="reload">æœç´¢</button>
                        </div>
                        <div class="site-text" style="margin: 5%; display: none" id="chemicalBox4" target="test123">
                            <form class="layui-form layui-form-pane" onsubmit="return false" id="chemicalBook4" lay-filter="chemicalt4">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">å¤‡æ³¨</label>
                                    <div class="layui-input-block">
                                        <input id="chemicalDes1" class="layui-input" /></br>
                                    </div>
                                    <label class="layui-form-label">ä»“åº“</label>
                                    <div class="layui-input-block">
                                        <select id="chemicalWarehouseId1"></select>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <table class="layui-hide" id="test2" lay-filter="test2"></table>
                        <script type="text/html" id="barDemo2">
                            <a class="layui-btn layui-btn-xs" lay-event="edit2">å…¥åº“</a>
                        </script>
                        <!--åºå·åˆ—-->
                        <script type="text/html" id="xuHao">
                            {{d.LAY_TABLE_INDEX+1}}
                        </script>
                    </div>
                </div>
                <div class="layui-tab-item">
                    <div class="officeFather">
                        <div class="demoTable">
                            æœç´¢åŠå…¬ç”¨å“åç§°ï¼š
                            <div class="layui-inline">
                                <input class="layui-input" name="name" id="officeName" autocomplete="off" />
                            </div>
                            <button class="layui-btn" data-type="reload">æœç´¢</button>
                        </div>
                        <table class="layui-hide" id="test3" lay-filter="test3"></table>
                        <div class="site-text" style="margin: 5%; display: none" id="officeBox3" target="test123">
                            <form class="layui-form layui-form-pane" onsubmit="return false" id="officeBook3" lay-filter="officet3">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">å¤‡æ³¨</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" name="name" autocomplete="off" id="officeDes" placeholder="å¤‡æ³¨è¯´æ˜" /></br>
                                    </div>
                                    <label class="layui-form-label">ä»“åº“</label>
                                    <div class="layui-input-block">
                                        <select id="officeWarehouseId"></select>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <script type="text/html" id="barDemo3">
                            <a class="layui-btn layui-btn-xs" lay-event="edit3">å…¥åº“</a>
                        </script>
                        <!--åºå·åˆ—-->
                        <script type="text/html" id="xuHao">
                            {{d.LAY_TABLE_INDEX+1}}
                        </script>
                    </div>
                </div>
                <div class="layui-tab-item">
                    <div class="productFather">
                        <div class="demoTable">
                            æœç´¢åç§°ï¼š
                            <div class="layui-inline">
                                <input class="layui-input" name="name" id="productName" autocomplete="off" />
                            </div>
                            <button class="layui-btn" data-type="reload">æœç´¢</button>
                        </div>
                        <table class="layui-hide" id="test4" lay-filter="test4"></table>
                        <div class="site-text" style="margin: 5%; display: none" id="productBox4" target="test123">
                            <form class="layui-form layui-form-pane" onsubmit="return false" id="productBook4" lay-filter="productt4">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">å¤‡æ³¨</label>
                                    <div class="layui-input-block">
                                        <input id="productDes1" class="layui-input" /></br>
                                    </div>
                                    <label class="layui-form-label">ä»“åº“</label>
                                    <div class="layui-input-block">
                                        <select id="productWarehouseId1"></select>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="site-text" style="margin: 5%; display: none" id="productBox5" target="test123">
                            <form class="layui-form layui-form-pane" onsubmit="return false" id="productBook5" lay-filter="productt5">
                                <div class="layui-form-item">
                                    <!-- <input type="hidden" id="leaderId"> -->
                                    <label class="layui-form-label">å¤‡æ³¨</label>
                                    <div class="layui-input-block">
                                        <input type="text" class="layui-input" id="productOverDes"><br>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <script type="text/html" id="barDemo4">
                            <a class="layui-btn layui-btn-xs" lay-event="edit4">å…¥åº“</a>
                            <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="over4">é©³å›</a>
                        </script>
                        <!--åºå·åˆ—-->
                        <script type="text/html" id="xuHao">
                            {{d.LAY_TABLE_INDEX+1}}
                        </script>
                        <!--ä¿¡æ¯-->
                        <script type="text/html" id="buttonTpl">
                            {{# if(d.Finshed_Sign == 1){ }}
                            <button class="layui-btn layui-btn-warm layui-btn-xs">æˆå“</button> {{# } else if(d.Finshed_Sign == 2) { }}
                            <button class="layui-btn  layui-btn-xs">åŠæˆå“</button> {{# } }}
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    billPurchaseBtn();

    function billPurchaseBtn() {
        $(".mapHead").css("display", "block")
        purchaseArr()
    }
    $("#billPurchaseBtn").click(function() {
        $(".mapHead").css("display", "block")
        purchaseArr()

    });
    $("#billChemicalBtn").click(function() {
        $(".chemisterFather").css("display", "block");
        ChemicalArr();
    })
    $("#billOfficeBtn").click(function() {
        $(".officeFather").css("display", "block");
        officeArr();
    });
    $("#billProductBtn").click(function() {

            $(".productFather").css("display", "block");
            ProductArr();

        })
        //è®¾ç½®å›¾ç‰‡çš„æ”¾å¤§æ•ˆæœ
    function hoverOpenImg() {
        var img_show = null; //tipsæç¤º
        $('td img').hover(function() {
            var img = "<img class='img_msg'src='" + $(this).attr('src') + "' style='width:170px;height:200px'/>";
            img_show = layer.tips(img, this, {
                tips: [2, 'rgba(41,41,41,.5)'],
                area: ['200px']
            });
        }, function() {
            layer.close(img_show);
        });
        $('td img').attr('style', 'max-width:50px');
    }

    function purchaseArr() {
        //é¢†å¯¼å®¡æ‰¹çš„è¡¨
        function warehouse(rawid) {
            $.ajax({
                type: 'POST',
                headers: {
                    Authorization: window.header.Ae,
                    UserId: window.header.Ud,
                    AppFlag: window.header.Fg
                },
                url: window.url + "ZpurChase/BackEntitys", //åå°æ•°æ®åœ°å€
                data: {
                    RawId: rawid,

                },
                success: function(data) {

                    $.each(data, function(index, item) { //å¾ªç¯åå°è¿”å›çš„jsonæ•°æ®

                        //new Optionæ–¹æ³•æ˜¯æ–°å»ºä¸€ä¸ªoptionï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦æ˜¾ç¤ºçš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯optionçš„valueå€¼,ç„¶åappendåˆ°ä¸‹æ‹‰æ¡†ä¸­ã€‚

                        $("#warehouseId").append(new Option(item.entrepot.EntrepotName, item.EntrepotId));
                    })
                    layui.form.render('select');
                }
            });
        }


        layui.use(['laypage', 'layer', 'table', 'element', 'jquery', 'form'], function() {
            var laypage = layui.laypage //åˆ†é¡µ
                ,
                layer = layui.layer //å¼¹å±‚
                ,
                table = layui.table //è¡¨æ ¼
                ,
                element = layui.element //å…ƒç´ æ“ä½œ
                ,
                form = layui.form;

            table.render({
                elem: '#test1',
                height: 515,
                url: window.url + 'ZpurChase/GetAddPursh' //æ•°æ®æ¥å£
                    ,
                title: 'æ£€éªŒå…¥åº“',
                id: 'testReload',
                toolbar: '#toolbarDemo' //å¼€å¯å¤´éƒ¨å·¥å…·æ ï¼Œå¹¶ä¸ºå…¶ç»‘å®šå·¦ä¾§æ¨¡æ¿
                    ,
                headers: {
                    Authorization: window.header.Ae,
                    UserId: window.header.Ud,
                    AppFlag: window.header.Fg
                },
                method: 'post',
                page: true, //å¼€å¯åˆ†é¡µ
                limit: 10,

                cols: [
                    [{
                        type: 'checkbox',
                        fixed: 'left'
                    }, {
                        title: 'åºå·',
                        fixed: 'left',
                        templet: '#xuHao',
                    }, {
                        field: 'z_Raw',
                        title: 'åŸææ–™',
                        fixed: 'left',
                        templet: function(res) {
                            if (res.z_Raw == null || res.z_Raw.Name == null) {
                                return "æ— "
                            } else {
                                return res.z_Raw.Name;
                            }
                        }
                    }, {
                        field: 'Z_RowType',
                        title: 'ç±»å‹',
                        fixed: 'left',
                        templet: function(res) {
                            if (res.Z_RowType == null || res.Z_RowType.Name == null) {
                                return "æ— "
                            } else {
                                return res.z_Raw.Name;
                            }
                        }
                    }, {
                        field: 'Project',
                        title: 'é¡¹ç›®',
                        fixed: 'left',
                        templet: function(res) {
                            if (res.Project == null || res.Project.Name == null) {
                                return "æ— "
                            } else {
                                return res.Project.Name;
                            }
                        }
                    }, {
                        field: 'ApplyNumber',
                        title: 'ç”³è¯·æ•°é‡',
                    }, {
                        field: 'Company',
                        title: 'å•ä½',
                        templet: function(res) {
                            if (res.company == null || res.company.Name == null) {
                                return "æ— "
                            } else {
                                return res.company.Name;
                            }
                        }
                    }, {
                        field: 'Supplier',
                        title: 'ä¾›è´§å•†',
                        templet: function(res) {
                            if (res.Supplier == null || res.Supplier.Name == null) {
                                return "æ— "
                            } else {
                                return res.Supplier.Name;
                            }
                        }
                    }, {
                        field: 'Amount',
                        title: 'é‡‘é¢',
                    }, {
                        field: 'PurchaseAmount',
                        title: 'ç”³è¯·çš„æ•°é‡'
                    }, {
                        field: 'Purpose',
                        title: 'ç”¨é€”',
                    }, {
                        field: 'Price',
                        title: 'å•ä»·',
                    }, {
                        field: 'WaybillNumber',
                        title: 'è¿å•å·',
                    }, {
                        field: 'PurchaseContract',
                        title: 'é‡‡è´­åˆåŒ',
                        templet: function(res) {
                            if (res.PurchaseContract != null) {
                                if (res.PurchaseContract.lastIndexOf("jpg") != -1 || res.PurchaseContract.lastIndexOf("png") != -1) {
                                    return "<div> <a href='" + window.urlImg + res.PurchaseContract + "' target='_blank'> <img src='" + window.urlImg + res.PurchaseContract + "' id='image'></a></div>"
                                }
                                return "<div><a href='" + window.urlImg + res.PurchaseContract + "' target='_blank'> <img src='../img/2.jpg' id='image' > </a></div>"
                            } else {
                                return "<div><img src='../img/2.jpg' id='image' ></a></div>"
                            }

                        }
                    }, {
                        field: 'ExpectArrivalTime',
                        title: 'æœŸæœ›åˆ°è´§æ—¥æœŸ',
                    }, {
                        field: 'ArrivalTime',
                        title: 'åˆ°è´§æ—¥æœŸ',
                    }, {
                        field: 'AssetExpenditureDesc',
                        title: 'æ”¯å‡ºå¤‡æ³¨',
                    }, {
                        field: 'ApplyTime',
                        title: 'ç”³è¯·æ—¥æœŸ',
                        templet: function(res) {
                            return showTime(res.ApplyTime);
                        }
                    }, {
                        fixed: 'right',
                        title: 'æ“ä½œ',
                        width: 240,
                        toolbar: '#barDemo',
                    }]
                ],
                request: {
                    pageName: 'PageIndex' // é¡µç çš„å‚æ•°åç§°ï¼Œé»˜è®¤ï¼špage
                        ,
                    limitName: 'PageSize' //æ¯é¡µæ•°æ®é‡çš„å‚æ•°åï¼Œé»˜è®¤ï¼šlimit
                },
                parseData: (res) => { //å°†åŸå§‹æ•°æ®è§£ææˆÂ tableÂ ç»„ä»¶æ‰€è§„å®šçš„æ•°æ®


                    return {
                        "code": 0, //è§£ææ¥å£çŠ¶æ€
                        "msg": "æˆåŠŸ", //è§£ææç¤ºæ–‡æœ¬
                        "count": res.Count, //æ€»æ•°
                        data: res.data //è§£ææ•°æ®åˆ—è¡¨
                    }
                }
            });

            //å¯»æ‰¾æ•°æ®
            $('.layui-btn').on('click', function() {
                var keyName = $("#keyName").val();
                //æ‰§è¡Œé‡è½½
                table.reload('testReload', {
                    page: {
                        curr: 1 //é‡æ–°ä»ç¬¬ 1 é¡µå¼€å§‹
                    },
                    where: {
                        DepartmentName: keyName
                    }
                }, 'data');
            });



            //ç›‘å¬è¡Œå·¥å…·äº‹ä»¶
            table.on('tool(test1)', function(obj) { //æ³¨ï¼štool æ˜¯å·¥å…·æ¡äº‹ä»¶åï¼Œtest æ˜¯ table åŸå§‹å®¹å™¨çš„å±æ€§ lay-filter="å¯¹åº”çš„å€¼"
                var data = obj.data //è·å¾—å½“å‰è¡Œæ•°æ®
                layEvent = obj.event; //è·å¾— lay-event å¯¹åº”çš„å€¼ 
                data.RawId

                warehouse(data.RawId);
                if (layEvent === 'edit') {
                    layer.open({
                        type: 1,
                        skin: 'layui-layer-molv',
                        area: ['400px', '300px'],
                        title: ['å…¥åº“', 'font-size:18px'],
                        btn: ['ç¡®å®š', 'å…³é—­'],
                        shadeClose: true,
                        shade: 0,
                        manmin: true,
                        content: $('#box3'),
                        yes: function(index, layero) {
                            $.ajax({
                                type: "POST",
                                url: window.url + "ZpurChase/AddPursh",
                                headers: {
                                    Authorization: window.header.Ae,
                                    UserId: window.header.Ud,
                                    AppFlag: window.header.Fg
                                },
                                contentType: "application/json",
                                data: JSON.stringify({
                                    Purchase_Id: data.PurchaseId,
                                    ContentDes: $("#des").val(),
                                    enportid: $("#warehouseId1").val(),
                                    user_Id: localStorage.getItem('UserId')
                                }),
                                success: function(res) {
                                    table.reload('testReload')
                                    $("#box3").css("display", "none");
                                    layer.close(index)
                                },
                                error: function(res) {
                                    layer.msg(res);
                                }

                            })
                        },
                        btn2: function(layero) {
                            $("#box3").css("display", "none");
                        },
                        cancel: function() {
                            $("#box3").css("display", "none");
                        }
                    });
                    return false;
                }

            });
            //åˆ†é¡µ
            laypage.render({
                elem: 'pageDemo' //åˆ†é¡µå®¹å™¨çš„id
                    ,
                count: 100 //æ€»é¡µæ•°
                    ,
                skin: '#1E9FFF' //è‡ªå®šä¹‰é€‰ä¸­è‰²å€¼
                    ,
                jump: function(obj, first) {
                    if (!first) {
                        layer.msg('ç¬¬' + obj.curr + 'é¡µ', {
                            offset: 'b'
                        });
                    }
                }
            });
        });
    }


    function ChemicalArr() {
        function ware(rawid) {
            $.ajax({
                type: 'POST',
                headers: {
                    Authorization: window.header.Ae,
                    UserId: window.header.Ud,
                    AppFlag: window.header.Fg
                },
                url: window.url + "ChemistryMonad/BackEntitys", //åå°æ•°æ®åœ°å€
                data: {
                    ChemistryId: rawid,

                },
                success: function(data) {


                    $.each(data, function(index, item) { //å¾ªç¯åå°è¿”å›çš„jsonæ•°æ®
                        //new Optionæ–¹æ³•æ˜¯æ–°å»ºä¸€ä¸ªoptionï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦æ˜¾ç¤ºçš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯optionçš„valueå€¼,ç„¶åappendåˆ°ä¸‹æ‹‰æ¡†ä¸­ã€‚

                        $("#chemicalWarehouseId1").append(new Option(item.entrepot.EntrepotName, item.EntrepotId));
                    })
                    layui.form.render('select');
                }
            });
        }
        layui.use(['laypage', 'layer', 'table', 'element', 'jquery', 'form'], function() {
            var laypage = layui.laypage //åˆ†é¡µ
                ,
                layer = layui.layer //å¼¹å±‚
                ,
                table = layui.table //è¡¨æ ¼
                ,
                element = layui.element //å…ƒç´ æ“ä½œ
                ,
                form = layui.form;

            table.render({
                elem: '#test2',
                height: 515,
                url: window.url + 'ChemistryMonad/GetAddChemistryMonad' //æ•°æ®æ¥å£
                    ,
                title: 'æ£€éªŒå…¥åº“',
                id: 'testReload2',
                toolbar: '#toolbarDemo2' //å¼€å¯å¤´éƒ¨å·¥å…·æ ï¼Œå¹¶ä¸ºå…¶ç»‘å®šå·¦ä¾§æ¨¡æ¿
                    ,
                headers: {
                    Authorization: window.header.Ae,
                    UserId: window.header.Ud,
                    AppFlag: window.header.Fg
                },
                method: 'post',
                page: true, //å¼€å¯åˆ†é¡µ
                limit: 10,

                cols: [
                    [{
                        type: 'checkbox',
                        fixed: 'left'
                    }, {
                        title: 'åºå·',
                        fixed: 'left',
                        templet: '#xuHao',
                    }, {
                        field: 'Z_Chemistry',
                        title: 'åŒ–å­¦',
                        fixed: 'left',
                        templet: function(res) {
                            if (res.Z_Chemistry == null || res.Z_Chemistry.Name == null) {
                                return "æ— "
                            } else {
                                return res.Z_Chemistry.Name;
                            }
                        }
                    }, {
                        field: 'Z_ChemistryType',
                        title: 'ç±»å‹',
                        fixed: 'left',
                        templet: function(res) {
                            if (res.Z_Chemistry.Z_ChemistryType == null || res.Z_Chemistry.Z_ChemistryType.Name == null) {
                                return "æ— "
                            } else {
                                return res.Z_Chemistry.Z_ChemistryType.Name;
                            }
                        }
                    }, {
                        field: 'ApplyNumber',
                        title: 'ç”³è¯·æ•°é‡',
                    }, {
                        field: 'Company',
                        title: 'å•ä½',
                        templet: function(res) {
                            if (res.Company == null || res.Company.Name == null) {
                                return "æ— "
                            } else {
                                return res.Company.Name;
                            }
                        }
                    }, {
                        field: 'Supplier',
                        title: 'ä¾›è´§å•†',
                        templet: function(res) {
                            if (res.Supplier == null || res.Supplier.Name == null) {
                                return "æ— "
                            } else {
                                return res.Supplier.Name;
                            }
                        }
                    }, {
                        field: 'Amount',
                        title: 'é‡‘é¢',
                    }, {
                        field: 'PurchaseAmount',
                        title: 'ç”³è¯·çš„æ•°é‡'
                    }, {
                        field: 'Purpose',
                        title: 'ç”¨é€”',
                    }, {
                        field: 'Price',
                        title: 'å•ä»·',
                    }, {
                        field: 'WaybillNumber',
                        title: 'è¿å•å·',
                    }, {
                        field: 'PurchaseContract',
                        title: 'é‡‡è´­åˆåŒ',
                        templet: function(res) {
                            if (res.PurchaseContract != null) {
                                if (res.PurchaseContract.lastIndexOf("jpg") != -1 || res.PurchaseContract.lastIndexOf("png") != -1) {
                                    return "<div> <a href='" + window.urlImg + res.PurchaseContract + "' target='_blank'> <img src='" + window.urlImg + res.PurchaseContract + "' id='image'></a></div>"
                                }
                                return "<div><a href='" + window.urlImg + res.PurchaseContract + "' target='_blank'> <img src='../img/2.jpg' id='image' > </a></div>"
                            } else {
                                return "<div><img src='../img/2.jpg' id='image' ></a></div>"
                            }

                        }
                    }, {
                        field: 'ExpectArrivalTime',
                        title: 'æœŸæœ›åˆ°è´§æ—¥æœŸ',
                    }, {
                        field: 'ArrivalTime',
                        title: 'åˆ°è´§æ—¥æœŸ',
                    }, {
                        field: 'AssetExpenditureDesc',
                        title: 'æ”¯å‡ºå¤‡æ³¨',
                    }, {
                        field: 'ApplyTime',
                        title: 'ç”³è¯·æ—¥æœŸ',
                        templet: function(res) {
                            return showTime(res.ApplyTime);
                        }
                    }, {
                        fixed: 'right',
                        title: 'æ“ä½œ',
                        width: 240,
                        toolbar: '#barDemo2',
                    }]
                ],
                request: {
                    pageName: 'PageIndex' // é¡µç çš„å‚æ•°åç§°ï¼Œé»˜è®¤ï¼špage
                        ,
                    limitName: 'PageSize' //æ¯é¡µæ•°æ®é‡çš„å‚æ•°åï¼Œé»˜è®¤ï¼šlimit
                },
                parseData: (res) => { //å°†åŸå§‹æ•°æ®è§£ææˆÂ tableÂ ç»„ä»¶æ‰€è§„å®šçš„æ•°æ®

                    return {
                        "code": 0, //è§£ææ¥å£çŠ¶æ€
                        "msg": "æˆåŠŸ", //è§£ææç¤ºæ–‡æœ¬
                        "count": res.Count, //æ€»æ•°
                        data: res.data //è§£ææ•°æ®åˆ—è¡¨
                    }
                }
            });

            //å¯»æ‰¾æ•°æ®
            $('.layui-btn').on('click', function() {
                var chemicalName = $("#chemicalName").val();
                //æ‰§è¡Œé‡è½½
                table.reload('testReload2', {
                    page: {
                        curr: 1 //é‡æ–°ä»ç¬¬ 1 é¡µå¼€å§‹
                    },
                    where: {
                        Name: chemicalName
                    }
                }, 'data');
            });



            //ç›‘å¬è¡Œå·¥å…·äº‹ä»¶
            table.on('tool(test2)', function(obj) { //æ³¨ï¼štool æ˜¯å·¥å…·æ¡äº‹ä»¶åï¼Œtest æ˜¯ table åŸå§‹å®¹å™¨çš„å±æ€§ lay-filter="å¯¹åº”çš„å€¼"
                var data = obj.data //è·å¾—å½“å‰è¡Œæ•°æ®

                layEvent = obj.event; //è·å¾— lay-event å¯¹åº”çš„å€¼
                ware(data.ChemistryId)
                if (layEvent === 'edit2') {
                    layer.open({
                        type: 1,
                        skin: 'layui-layer-molv',
                        area: ['400px', '300px'],
                        title: ['å…¥åº“', 'font-size:18px'],
                        btn: ['ç¡®å®š', 'å…³é—­'],
                        shadeClose: true,
                        shade: 0,
                        manmin: true,
                        content: $('#chemicalBox4'),
                        yes: function(index, layero) {
                            $.ajax({
                                type: "POST",
                                url: window.url + "ChemistryMonad/AddChemistryMonad",
                                headers: {
                                    Authorization: window.header.Ae,
                                    UserId: window.header.Ud,
                                    AppFlag: window.header.Fg
                                },
                                contentType: "application/json",
                                data: JSON.stringify({
                                    ChemistryId: data.Id,
                                    ContentDes: $("#chemicalDes1").val(),
                                    enportid: $("#chemicalWarehouseId1").val(),
                                    user_Id: localStorage.getItem('UserId')
                                }),
                                success: function(res) {
                                    table.reload('testReload2')
                                    $("#chemicalBox4").css("display", "none");
                                    layer.close(index)
                                },
                                error: function(res) {
                                    layer.msg(res);
                                }

                            })
                        },
                        btn2: function(layero) {
                            $("#chemicalBox4").css("display", "none");
                        },
                        cancel: function() {
                            $("#chemicalBox4").css("display", "none");
                        }
                    });
                    return false;
                }

            });
            //åˆ†é¡µ
            laypage.render({
                elem: 'pageDemo' //åˆ†é¡µå®¹å™¨çš„id
                    ,
                count: 100 //æ€»é¡µæ•°
                    ,
                skin: '#1E9FFF' //è‡ªå®šä¹‰é€‰ä¸­è‰²å€¼
                    ,
                jump: function(obj, first) {
                    if (!first) {
                        layer.msg('ç¬¬' + obj.curr + 'é¡µ', {
                            offset: 'b'
                        });
                    }
                }
            });
        });
    }

    function officeArr() {
        function officehouse(officeId) {
            $.ajax({
                type: 'POST',
                headers: {
                    Authorization: window.header.Ae,
                    UserId: window.header.Ud,
                    AppFlag: window.header.Fg
                },
                url: window.url + 'OfficeMonad/BackEntitys', //åå°æ•°æ®åœ°å€
                data: {
                    OfficeId: officeId
                },
                success: function(data) {

                    //$.each(data, function(index, items) {
                    $.each(data, function(index, item) { //å¾ªç¯åå°è¿”å›çš„jsonæ•°æ® 

                            //new Optionæ–¹æ³•æ˜¯æ–°å»ºä¸€ä¸ªoptionï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦æ˜¾ç¤ºçš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯optionçš„valueå€¼,ç„¶åappendåˆ°ä¸‹æ‹‰æ¡†ä¸­ã€‚
                            $("#officeWarehouseId").append(new Option(item.entrepot.EntrepotName, item.Id));
                        })
                        //})

                    layui.form.render('select');
                }
            });
        }
        layui.use(['laypage', 'layer', 'table', 'element', 'jquery', 'form'], function() {
            var laypage = layui.laypage //åˆ†é¡µ
                ,
                layer = layui.layer //å¼¹å±‚
                ,
                table = layui.table //è¡¨æ ¼
                ,
                element = layui.element //å…ƒç´ æ“ä½œ
                ,
                form = layui.form;

            table.render({
                elem: '#test3',
                height: 515,
                url: window.url + 'OfficeMonad/GetAddOfficeMonad' //æ•°æ®æ¥å£
                    ,
                title: 'åŠå…¬å…¥åº“',
                id: 'testReload3',
                toolbar: '#toolbarDemo3' //å¼€å¯å¤´éƒ¨å·¥å…·æ ï¼Œå¹¶ä¸ºå…¶ç»‘å®šå·¦ä¾§æ¨¡æ¿
                    ,
                headers: {
                    Authorization: window.header.Ae,
                    UserId: window.header.Ud,
                    AppFlag: window.header.Fg
                },
                method: 'post',
                page: true, //å¼€å¯åˆ†é¡µ
                limit: 10,
                done: function(res, curr, count) {
                    hoverOpenImg(); //æ˜¾ç¤ºå¤§å›¾
                },
                cols: [
                    [{
                        type: 'checkbox',
                        fixed: 'left'
                    }, {
                        title: 'åºå·',
                        fixed: 'left',
                        templet: '#xuHao',
                    }, {
                        field: 'Z_Office',
                        title: 'åŠå…¬ç”¨å“',
                        fixed: 'left',
                        templet: function(res) {
                            return res.Z_Office.Name
                        }
                    }, {
                        field: 'Z_Office',
                        title: 'åŠå…¬ç”¨å“åç§°',
                        fixed: 'left',
                        templet: function(res) {
                            return res.Z_Office.Z_OfficeType.Name
                        }
                    }, {
                        field: 'ApplyNumber',
                        title: 'ç”³è¯·æ•°é‡',

                    }, {
                        field: 'Company',
                        title: 'å•ä½',
                        templet: function(res) {
                            return res.Company.Name
                        }
                    }, {
                        field: 'Supplier',
                        title: 'ä¾›è´§å•†',
                        templet: function(res) {
                            if (res.Supplier == null || res.Supplier.Name == null) {
                                return "æ— "
                            } else {
                                return res.Supplier.Name;
                            }
                        }
                    }, {
                        field: 'Amount',
                        title: 'é‡‘é¢',
                    }, {
                        field: 'Purpose',
                        title: 'ç”¨é€”',
                    }, {
                        field: 'Price',
                        title: 'å•ä»·',
                    }, {
                        field: 'WaybillNumber',
                        title: 'è¿å•å·',
                    }, {
                        field: 'PurchaseContract',
                        title: 'é‡‡è´­åˆåŒ',
                        templet: function(res) {
                            if (res.PurchaseContract != null) {
                                if (res.PurchaseContract.lastIndexOf("jpg") != -1 || res.PurchaseContract.lastIndexOf("png") != -1) {
                                    return "<div> <a href='" + window.urlImg + res.PurchaseContract + "' target='_blank'> <img src='" + window.urlImg + res.PurchaseContract + "' id='image'></a></div>"
                                }
                                return "<div><a href='" + window.urlImg + res.PurchaseContract + "' target='_blank'> <img src='../img/2.jpg' id='image' > </a></div>"
                            } else {
                                return "<div><img src='../img/2.jpg' id='image' ></a></div>"
                            }

                        }
                    }, {
                        field: 'ExpectArrivalTime',
                        title: 'æœŸæœ›åˆ°è´§æ—¥æœŸ',
                    }, {
                        field: 'ArrivalTime',
                        title: 'åˆ°è´§æ—¥æœŸ',
                    }, {
                        field: 'AssetExpenditureDesc',
                        title: 'æ”¯å‡ºå¤‡æ³¨',
                        templet: function(res) {
                            return showTime(res);
                        }
                    }, {
                        field: 'ApplyTime',
                        title: 'ç”³è¯·æ—¥æœŸ',
                        templet: function(res) {
                            return showTime(res.ApplyTime);
                        }
                    }, {
                        fixed: 'right',
                        title: 'æ“ä½œ',
                        width: 240,
                        toolbar: '#barDemo3',
                    }]
                ],
                request: {
                    pageName: 'PageIndex' // é¡µç çš„å‚æ•°åç§°ï¼Œé»˜è®¤ï¼špage
                        ,
                    limitName: 'PageSize' //æ¯é¡µæ•°æ®é‡çš„å‚æ•°åï¼Œé»˜è®¤ï¼šlimit
                },
                parseData: (res) => { //å°†åŸå§‹æ•°æ®è§£ææˆÂ tableÂ ç»„ä»¶æ‰€è§„å®šçš„æ•°æ®

                    return {
                        "code": 0, //è§£ææ¥å£çŠ¶æ€
                        "msg": "æˆåŠŸ", //è§£ææç¤ºæ–‡æœ¬
                        "count": res.Count, //æ€»æ•°
                        data: res.data //è§£ææ•°æ®åˆ—è¡¨
                    }
                }
            });

            //å¯»æ‰¾æ•°æ®
            $('.layui-btn').on('click', function() {
                var officeName = $("#officeName").val();
                //æ‰§è¡Œé‡è½½
                table.reload('testReload3', {
                    page: {
                        curr: 1 //é‡æ–°ä»ç¬¬ 1 é¡µå¼€å§‹
                    },
                    where: {
                        Name: officeName
                    }
                }, 'data');
            });



            //ç›‘å¬è¡Œå·¥å…·äº‹ä»¶
            table.on('tool(test3)', function(obj) { //æ³¨ï¼štool æ˜¯å·¥å…·æ¡äº‹ä»¶åï¼Œtest æ˜¯ table åŸå§‹å®¹å™¨çš„å±æ€§ lay-filter="å¯¹åº”çš„å€¼"

                var data = obj.data //è·å¾—å½“å‰è¡Œæ•°æ®
                layEvent = obj.event; //è·å¾— lay-event å¯¹åº”çš„å€¼

                officehouse(data.OfficeId);
                if (layEvent === 'edit3') {
                    layer.open({
                        type: 1,
                        skin: 'layui-layer-molv',
                        area: ['400px', '300px'],
                        title: ['å…¥åº“', 'font-size:18px'],
                        btn: ['ç¡®å®š', 'å…³é—­'],
                        shadeClose: true,
                        shade: 0,
                        manmin: true,
                        content: $('#officeBox3'),
                        yes: function(index, layero) {
                            $.ajax({
                                type: "POST",
                                url: window.url + "OfficeMonad/AddOfficeMonad",
                                headers: {
                                    Authorization: window.header.Ae,
                                    UserId: window.header.Ud,
                                    AppFlag: window.header.Fg
                                },
                                contentType: "application/json",
                                data: JSON.stringify({
                                    OfficeId: data.Id,
                                    ContentDes: $("#officeDes").val(),
                                    entrepotid: $("#officeWarehouseId").val(),
                                }),
                                success: function(res) {

                                    table.reload('testReload3')
                                    $("#officeBox3").css("display", "none");
                                    layer.close(index)
                                },
                                error: function(res) {

                                    layer.msg(res);
                                }

                            })
                        },
                        btn2: function(layero) {
                            $("#officeBox3").css("display", "none");
                        },
                        cancel: function() {
                            $("#officeBox3").css("display", "none");
                        }
                    });
                    return false;
                }

            });
            //åˆ†é¡µ
            laypage.render({
                elem: 'pageDemo' //åˆ†é¡µå®¹å™¨çš„id
                    ,
                count: 100 //æ€»é¡µæ•°
                    ,
                skin: '#1E9FFF' //è‡ªå®šä¹‰é€‰ä¸­è‰²å€¼
                    ,
                jump: function(obj, first) {
                    if (!first) {
                        layer.msg('ç¬¬' + obj.curr + 'é¡µ', {
                            offset: 'b'
                        });
                    }
                }
            });
        });
    }

    function ProductArr() {

        function productware(rawid) {
            $.ajax({
                type: 'POST',
                headers: {
                    Authorization: window.header.Ae,
                    UserId: window.header.Ud,
                    AppFlag: window.header.Fg
                },
                url: window.url + "SaleProduct/BackSaleMonad", //åå°æ•°æ®åœ°å€
                data: {
                    FishProductId: rawid,
                },
                success: function(data) {
                    console.log('%c ğŸ¯ data: ', 'font-size:20px;background-color: #7F2B82;color:#fff;', data);
                    $.each(data, function(index, item) { //å¾ªç¯åå°è¿”å›çš„jsonæ•°æ®
                        //new Optionæ–¹æ³•æ˜¯æ–°å»ºä¸€ä¸ªoptionï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦æ˜¾ç¤ºçš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯optionçš„valueå€¼,ç„¶åappendåˆ°ä¸‹æ‹‰æ¡†ä¸­ã€‚
                        $("#productWarehouseId1").append(new Option(item.entrepot.EntrepotName, item.EntrepotId));
                    })
                    layui.form.render('select');
                }
            });
        }
        layui.use(['laypage', 'layer', 'table', 'element', 'jquery', 'form'], function() {
            var laypage = layui.laypage //åˆ†é¡µ
                ,
                layer = layui.layer //å¼¹å±‚
                ,
                table = layui.table //è¡¨æ ¼
                ,
                element = layui.element //å…ƒç´ æ“ä½œ
                ,
                form = layui.form;

            table.render({
                elem: '#test4',
                height: 515,
                url: window.url + 'FinshedProductMonad/GetFinshedProductMonad' //æ•°æ®æ¥å£
                    ,
                title: 'æ£€éªŒå…¥åº“',
                id: 'testReload4',
                toolbar: '#toolbarDemo4' //å¼€å¯å¤´éƒ¨å·¥å…·æ ï¼Œå¹¶ä¸ºå…¶ç»‘å®šå·¦ä¾§æ¨¡æ¿
                    ,
                headers: {
                    Authorization: window.header.Ae,
                    UserId: window.header.Ud,
                    AppFlag: window.header.Fg
                },
                method: 'post',
                page: true, //å¼€å¯åˆ†é¡µ
                limit: 10,

                cols: [
                    [{
                        type: 'checkbox',
                        fixed: 'left'
                    }, {
                        title: 'åºå·',
                        fixed: 'left',
                        templet: '#xuHao',
                    }, {
                        field: 'z_FnishedProduct.Name',
                        title: 'äº§æˆå“',
                        fixed: 'left',
                        templet: function(res) {
                            if (res.z_FnishedProduct == null || res.z_FnishedProduct.Name == null) {
                                return "æ— "
                            } else {
                                return res.z_FnishedProduct.Name;
                            }
                        }
                    }, {
                        field: 'z_FnishedProduct.Z_FinshedProductType.Name',
                        title: 'ç±»å‹',
                        fixed: 'left',
                        templet: function(res) {
                            if (res.z_FnishedProduct.Z_FinshedProductType == null || res.z_FnishedProduct.Z_FinshedProductType.Name == null) {
                                return "æ— "
                            } else {
                                return res.z_FnishedProduct.Z_FinshedProductType.Name;
                            }
                        }
                    }, {
                        field: 'Finshed_Sign',
                        title: 'å‡ºå”®ç±»å‹',
                        fixed: 'left',
                        templet: '#buttonTpl',
                        minWidth: 150,
                        align: 'center'

                    }, {
                        field: 'ApplyNumber',
                        title: 'å…¥åº“æ•°é‡',
                    }, {
                        field: 'Company',
                        title: 'å•ä½',
                        templet: function(res) {
                            if (res.Company == null || res.Company.Name == null) {
                                return "æ— "
                            } else {
                                return res.Company.Name;
                            }
                        }
                    }, {
                        field: 'Supplier',
                        title: 'ä¾›è´§å•†',
                        templet: function(res) {
                            if (res.Supplier == null || res.Supplier.Name == null) {
                                return "æ— "
                            } else {
                                return res.Supplier.Name;
                            }
                        }
                    }, {
                        field: 'ApplyTime',
                        title: 'ç”³è¯·æ—¥æœŸ',
                        templet: function(res) {
                            return showTime(res.ApplyTime);
                        }
                    }, {
                        fixed: 'right',
                        title: 'æ“ä½œ',
                        width: 240,
                        toolbar: '#barDemo4',
                    }]
                ],
                request: {
                    pageName: 'PageIndex' // é¡µç çš„å‚æ•°åç§°ï¼Œé»˜è®¤ï¼špage
                        ,
                    limitName: 'PageSize' //æ¯é¡µæ•°æ®é‡çš„å‚æ•°åï¼Œé»˜è®¤ï¼šlimit
                },
                parseData: (res) => { //å°†åŸå§‹æ•°æ®è§£ææˆÂ tableÂ ç»„ä»¶æ‰€è§„å®šçš„æ•°æ®
                    console.log('%c ğŸ» res: ', 'font-size:20px;background-color: #FFDD4D;color:#fff;', res);

                    return {
                        "code": 0, //è§£ææ¥å£çŠ¶æ€
                        "msg": "æˆåŠŸ", //è§£ææç¤ºæ–‡æœ¬
                        "count": res.Count, //æ€»æ•°
                        data: res.data //è§£ææ•°æ®åˆ—è¡¨
                    }
                }
            });

            //å¯»æ‰¾æ•°æ®
            $('.layui-btn').on('click', function() {
                var productName = $("#productName").val();
                //æ‰§è¡Œé‡è½½
                table.reload('testReload4', {
                    page: {
                        curr: 1 //é‡æ–°ä»ç¬¬ 1 é¡µå¼€å§‹
                    },
                    where: {
                        Name: productName
                    }
                }, 'data');
            });



            //ç›‘å¬è¡Œå·¥å…·äº‹ä»¶
            table.on('tool(test4)', function(obj) { //æ³¨ï¼štool æ˜¯å·¥å…·æ¡äº‹ä»¶åï¼Œtest æ˜¯ table åŸå§‹å®¹å™¨çš„å±æ€§ lay-filter="å¯¹åº”çš„å€¼"
                var data = obj.data //è·å¾—å½“å‰è¡Œæ•°æ®

                layEvent = obj.event; //è·å¾— lay-event å¯¹åº”çš„å€¼
                console.log('%c ğŸ¡ data.FnishedProductId: ', 'font-size:20px;background-color: #ED9EC7;color:#fff;', data.FnishedProductId);
                productware(data.FnishedProductId);
                data.Id
                console.log('%c ğŸ¥˜ data.Id: ', 'font-size:20px;background-color: #FFDD4D;color:#fff;', data.Id);
                if (layEvent === 'edit4') {
                    layer.open({
                        type: 1,
                        skin: 'layui-layer-molv',
                        area: ['400px', '300px'],
                        title: ['å…¥åº“', 'font-size:18px'],
                        btn: ['ç¡®å®š', 'å…³é—­'],
                        shadeClose: true,
                        shade: 0,
                        manmin: true,
                        content: $('#productBox4'),
                        yes: function(index, layero) {
                            $.ajax({
                                type: "POST",
                                url: window.url + "FinshedProductMonad/AddFinshedProductMonad",
                                headers: {
                                    Authorization: window.header.Ae,
                                    UserId: window.header.Ud,
                                    AppFlag: window.header.Fg
                                },
                                contentType: "application/json",
                                data: JSON.stringify({
                                    FinishProductId: data.Id,
                                    ContentDes: $("#productDes1").val(),
                                    enportid: $("#productWarehouseId1").val(),
                                    user_Id: localStorage.getItem('UserId')
                                }),
                                success: function(res) {

                                    table.reload('testReload4')
                                    $("#productBox4").css("display", "none");
                                    layer.close(index)
                                },
                                error: function(res) {
                                    layer.msg(res);
                                }

                            })
                        },
                        btn2: function(layero) {
                            $("#productBox4").css("display", "none");
                        },
                        cancel: function() {
                            $("#productBox4").css("display", "none");
                        }
                    });
                    return false;
                } else if (layEvent === "over4") {
                    layer.open({
                        type: 1,
                        skin: 'layui-layer-molv',
                        area: ['400px', '200px'],
                        title: ['å¤‡æ³¨', 'font-size:18px'],
                        btn: ['ç¡®å®š', 'å…³é—­'],
                        shadeClose: true,
                        shade: 0,
                        manmin: true,
                        content: $('#productBox5'),
                        yes: function(index, layero) {
                            $.ajax({
                                type: "POST",
                                url: window.url + "SaleProduct/SetRejectSaleMonad",
                                headers: {
                                    Authorization: window.header.Ae,
                                    UserId: window.header.Ud,
                                    AppFlag: window.header.Fg
                                },
                                contentType: "application/json",
                                data: JSON.stringify({
                                    Sale_Id: data.Id,
                                    Des: $("#productOverDes").val(),
                                }),
                                success: function(res) {
                                    console.log('%c ğŸ res: ', 'font-size:20px;background-color: #E41A6A;color:#fff;', res);
                                    // table.reload('testReload4')
                                    // $("#productBox5").css("display", "none");
                                    // layer.close(index)
                                },
                                error: function(res) {
                                    layer.msg(res);
                                }

                            })
                        },
                        btn2: function(layero) {
                            $("#productBox5").css("display", "none");
                        },
                        cancel: function() {
                            $("#productBox5").css("display", "none");
                        }
                    });
                    return false;
                }


            });
            //åˆ†é¡µ
            laypage.render({
                elem: 'pageDemo' //åˆ†é¡µå®¹å™¨çš„id
                    ,
                count: 100 //æ€»é¡µæ•°
                    ,
                skin: '#1E9FFF' //è‡ªå®šä¹‰é€‰ä¸­è‰²å€¼
                    ,
                jump: function(obj, first) {
                    if (!first) {
                        layer.msg('ç¬¬' + obj.curr + 'é¡µ', {
                            offset: 'b'
                        });
                    }
                }
            });
        });
    }
</script>

</html>